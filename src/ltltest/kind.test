#! /bin/sh
# -*- coding: utf-8 -*-
# Copyright (C) 2010, 2011, 2012, 2015 Laboratoire de Recherche et
# DÃ©veloppement de l'Epita (LRDE).
#
# This file is part of Spot, a model checking library.
#
# Spot is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# Spot is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.


# Check for the constant_term visitor

. ./defs || exit 1

set -e

cat >input<<EOF
a,B&!xfLEPSFsgopr
a<->b,BxfLEPSFsgopr
!a,B&!xfLEPSFsgopr
!(a|b),B&xfLEPSFsgopr
F(a),&!xLPegopr
G(a),&!xLPusopr
a U b,&!xfLPgopr
a U Fb,&!xLPegopr
Ga U b,&!xLPopr
1 U a,&!xfLPegopr
a W b,&!xfLPsopr
a W 0,&!xfLPusopr
a M b,&!xfLPgopr
a M 1,&!xfLPegopr
a R b,&!xfLPsopr
0 R b,&!xfLPusopr
a R (b R (c R d)),&!xfLPsopr
a U (b U (c U d)),&!xfLPgopr
a W (b W (c W d)),&!xfLPsopr
a M (b M (c M d)),&!xfLPgopr
Fa -> Fb,xLPopr
Ga -> Fb,xLPgopr
Fa -> Gb,xLPsopr
(Ga|Fc) -> Fb,xLPopr
(Ga|Fa) -> Gb,xLPopr
{a;c*;b}|->!Xb,&fPsopr
{a;c*;b}|->X!b,&!fPsopr
{a;c*;b}|->!Fb,&Psopr
{a;c*;b}|->G!b,&!Psopr
{a;c*;b}|->!Gb,&Pr
{a;c*;b}|->F!b,&!Pr
{a;c*;b}|->GFa,&!Pr
{a;c*;b}|->FGa,&!P
{a[+];c[+];b*}|->!Fb,&xPsopr
{a[+];c*;b[+]}|->G!b,&!xPsopr
{a*;c[+];b[+]}|->!Gb,&xPr
{a[+];c*;b[+]}|->F!b,&!xPr
{a[+];c[+];b*}|->GFa,&!xPr
{a*;c[+];b[+]}|->FGa,&!xP
{a;c;b|(d;e)}|->!Xb,&fPFsgopr
{a;c;b|(d;e)}|->X!b,&!fPFsgopr
{a;c;b|(d;e)}|->!Fb,&Psopr
{a;c;b|(d;e)}|->G!b,&!Psopr
{a;c;b|(d;e)}|->!Gb,&Pgopr
{a;c;b|(d;e)}|->F!b,&!Pgopr
{a;c;b|(d;e)}|->GFa,&!Pr
{a;c;b|(d;e)}|->FGa,&!Pp
{a[+] && c[+]}|->!Xb,&fPsopr
{a[+] && c[+]}|->X!b,&!fPsopr
{a[+] && c[+]}|->!Fb,&xPsopr
{a[+] && c[+]}|->G!b,&!xPsopr
{a[+] && c[+]}|->!Gb,&xPr
{a[+] && c[+]}|->F!b,&!xPr
{a[+] && c[+]}|->GFa,&!xPr
{a[+] && c[+]}|->FGa,&!xP
{a;c*;b}<>->!Gb,&Pgopr
{a;c*;b}<>->F!b,&!Pgopr
{a;c*;b}<>->FGb,&!Pp
{a;c*;b}<>->!GFb,&Pp
{a;c*;b}<>->GFb,&!P
{a;c*;b}<>->!FGb,&P
{a*;c[+];b[+]}<>->!FGb,&xP
{a;c|d;b}<>->!Gb,&Pgopr
{a;c|d;b}<>->G!b,&!Psopr
{a;c|d;b}<>->FGb,&!Pp
{a;c|d;b}<>->!GFb,&Pp
{a;c|d;b}<>->GFb,&!Pr
{a;c|d;b}<>->!FGb,&Pr
# Equivalent to a&b&c&d
{a:b:c:d}!,B&!xfLEPSFsgopr
a&b&c&d,B&!xfLEPSFsgopr
(Xa <-> XXXc) U (b & Fe),LPgopr
(!X(a|X(!b))&(FX(g xor h)))U(!G(a|b)),LPegopr
(!X(a|X(!b))&(GX(g xor h)))R(!F(a|b)),LPusopr
(!X(a|X(!b))&(GX(g xor h)))U(!G(a|b)),LPeopr
(!X(a|X(!b))&(FX(g xor h)))R(!F(a|b)),LPuopr
(!X(a|X(!b))&(GX(g xor h)))U(!F(a|b)),LPp
(!X(a|X(!b))&(FX(g xor h)))R(!G(a|b)),LPr
(!X(a|GXF(!b))&(FGX(g xor h)))U(!F(a|b)),LPp
(!X(a|GXF(!b))&(FGX(g xor h)))R(!F(a|b)),LPup
(!X(a|FXG(!b))&(GFX(g xor h)))R(!G(a|b)),LPr
(!X(a|FXG(!b))&(GFX(g xor h)))U(!G(a|b)),LPer
(!X(a|GXF(!b))&(FGX(g xor h)))U(!G(a|Fb)),LPep
(!X(a|GXF(!b))&(FGX(g xor h)))U(!F(a|Gb)),LP
(!X(a|FXG(!b))&(GFX(g xor h)))R(!F(a|Gb)),LPur
(!X(a|FXG(!b))&(GFX(g xor h)))R(!G(a|Fb)),LP
GFa M GFb,&!xLPeu
FGa M FGb,&!xLPeup
Fa  M GFb,&!xLPer
GFa W GFb,&!xLPeur
FGa W FGb,&!xLPeu
Ga  W FGb,&!xLPup
Ga  W b,&!xLPsopr
Fa  M b,&!xLPgopr
{a;b*;c},&!fPsopr
{a;b*;c}!,&!fPgopr
# The negative normal form is {a;b*;c}[]->1
!{a;b*;c}!,&fPsopr
{a;b*;c}[]->0,&!fPsopr
!{a;b*;c},&!fPgopr
!{a[+];b*;c[+]},&!xfPgopr
{a[+];b*;c[+]},&!xfPsopr
{a[+] && b || c[+]},&!fPsopr
{a[+] && b[+] || c[+]},&!xfPsopr
EOF

run 0 ../kind input

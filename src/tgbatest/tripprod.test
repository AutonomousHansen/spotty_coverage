#!/bin/sh

. ./defs

set -e

cat >input1 <<EOF
s1, s3, a,;
s1, s2, b, p1;
s2, s1, !a,;
s2, s3, c,;
EOF

cat >input2 <<EOF
s1, s2, b, p2;
s2, s1, a, p3;
EOF

cat >input3 <<EOF
s1, s2, a,;
s1, s3, b,;
s3, s2,, p4;
s2, s3,, p4;
EOF

cat >expected <<EOF
"s1 * s1 * s1", "s3 * s2 * s2", a b, "p2";
"s1 * s1 * s1", "s2 * s2 * s2", a b, "p2" "p1";
"s2 * s2 * s2", "s3 * s1 * s3", c a, "p3" "p4";
"s1 * s1 * s1", "s3 * s2 * s3", a b, "p2";
"s1 * s1 * s1", "s2 * s2 * s3", b, "p2" "p1";
"s2 * s2 * s3", "s3 * s1 * s2", c a, "p3" "p4";
EOF

./tripprod input1 input2 input3 > stdout

cat stdout
diff stdout expected
rm input1 input2 input3 stdout expected

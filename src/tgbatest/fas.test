#!/bin/sh
# Copyright (C) 2014 Laboratoire de Recherche et DÃ©veloppement
# de l'Epita (LRDE).
#
# This file is part of Spot, a model checking library.
#
# Spot is free software; you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published by
# the Free Software Foundation; either version 3 of the License, or
# (at your option) any later version.
#
# Spot is distributed in the hope that it will be useful, but WITHOUT
# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
# or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public
# License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

. ./defs

set -e

cat << EOF > in.spot
acc = "2";
"2", "1", "a", "";
"1", "2", "a", "";
"1", "3", "a", "";

"3", "4", "a", "";
"3", "5", "a", "";
"3", "6", "a", "";
"6", "5", "a", "";

"4", "5", "a", "";
"5", "4", "a", "";
EOF

cat << EOF > out.exp
digraph G {
  0 [label="", style=invis, height=0]
  0 -> 1
  1 [label="2"]
  1 -> 2 [color="red"]
  2 [label="1"]
  2 -> 1 []
  2 -> 3 [color="red"]
  3 [label="3"]
  3 -> 4 []
  3 -> 5 []
  3 -> 6 []
  4 [label="4"]
  4 -> 5 [color="red"]
  5 [label="5"]
  5 -> 4 []
  6 [label="6"]
  6 -> 5 []
}
EOF

run 0 ../fas in.spot > out.gv
cmp out.gv out.exp

cat << EOF > in2.spot
acc = "2";
"1", "2", "a", "";
"2", "3", "a", "";
"3", "1", "a", "";
EOF

cat << EOF > out2.exp
digraph G {
  0 [label="", style=invis, height=0]
  0 -> 1
  1 [label="1"]
  1 -> 2 []
  2 [label="2"]
  2 -> 3 [color="red"]
  3 [label="3"]
  3 -> 1 []
}
EOF

run 0 ../fas in2.spot > out2.gv
cmp out2.gv out2.exp

cat << EOF > in3.spot
acc = "2";
"1", "2", "a", "";
"2", "3", "a", "";
"3", "1", "a", "";
"3", "4", "a", "";
"4", "5", "a", "";
"5", "1", "a", "";
EOF

cat << EOF > out3.exp
digraph G {
  0 [label="", style=invis, height=0]
  0 -> 1
  1 [label="1"]
  1 -> 2 []
  2 [label="2"]
  2 -> 3 [color="red"]
  3 [label="3"]
  3 -> 1 []
  3 -> 4 []
  4 [label="4"]
  4 -> 5 []
  5 [label="5"]
  5 -> 1 []
}
EOF

run 0 ../fas in3.spot > out3.gv
cmp out3.gv out3.exp

cat << EOF > in4.spot
acc = "2";
"1", "2", "a", "";
"2", "3", "a", "";
"3", "1", "a", "";
"3", "4", "a", "";
"4", "5", "a", "";
"5", "3", "a", "";
EOF

cat << EOF > out4.exp
digraph G {
  0 [label="", style=invis, height=0]
  0 -> 1
  1 [label="1"]
  1 -> 2 []
  2 [label="2"]
  2 -> 3 [color="red"]
  3 [label="3"]
  3 -> 1 []
  3 -> 4 []
  4 [label="4"]
  4 -> 5 [color="red"]
  5 [label="5"]
  5 -> 3 []
}
EOF

run 0 ../fas in4.spot > out4.gv
cmp out4.gv out4.exp
